\documentclass{article}
\usepackage{hyperref}
\usepackage{bm}
\usepackage{amsfonts}

\title{SoftSpokenOT protocol}
\author{Silence Laboratories}
\date{March 2025}

\begin{document}

\maketitle
This protocol refers to the protocol described in Fig.10 \cite{keller2015actively} with changes in the
reduction of communication by a factor of k due to an increase in computation by a factor of $2^{k-1} / k$.

The protocol uses an arbitrary stretch pseudorandom generator, $\mathsf{PRG}$, and a hash functions 
$\mathsf{H}_1: \{0,1\}^* \rightarrow \{0,1\}^{s}$, $\mathsf{H}_2: \{0,1\}^* \rightarrow \{0,1\}^{\kappa}$, modeled as a random oracle. \\
$s = 128$, $k = 4$.

\paragraph{Initialize:}
    \begin{enumerate}
        \item R samples $\kappa$ pairs of random $\kappa$-bit seed, $\{(\bm{k}_0^i, \bm{k}_1^i)\}_{i=1}^{\kappa}$
        \item S samples a random $\Delta = (\Delta_1, \dots, \Delta_{\kappa}) \in \mathbb{F}_2^{\kappa}$.
        \item The parties call $\kappa \times OT_{\kappa}$ with inputs $\Delta$ and $k_0$, $k_1$.
        \item S receives $\bm{k}_{\Delta_i}^i$, for $i = 1, \dots, \kappa$.

        \item R and S run protocols described in Fig.13 and Fig.14 \cite{roy2022softspokenot}
        
        to convert their $\kappa \times \left(\begin{array}{c} 2 \\ 1 \end{array} \right)$-OT to all-but-one $(\kappa / k) \times \left(\begin{array}{c} 2^k \\ 2^k - 1 \end{array} \right)$-OT.
        In $\left(\begin{array}{c} 2^k \\ 2^k - 1 \end{array} \right)$-OT a random function $F: \mathbb{F}_{2^k} \rightarrow \mathbb{F}_2^{l}$ is known to R,
    while S has a random point $\Delta$ and the restriction $F^{*}$ of $F$ to $\mathbb{F}_{2^k} \setminus  \{\Delta\}$.
        
    \end{enumerate}

\paragraph{Extend:}

  \begin{enumerate}
     \item According to Fig.7 \cite{roy2022softspokenot}, R computes: \\
        \begin{displaymath}
            r_x^{i} = \mathsf{PRG}(F^{i}(x)) \in \mathbb{F}_2^{l'} \quad \textrm{for} \,\, x \in F_{2^k},
        \end{displaymath}
        \begin{displaymath}
            u^i = \sum_{x \in F_{2^k}} r_x^{i}, \quad \textrm{and} \quad v^i = -\sum_{x \in F_{2^k}} r_x^{i} \cdot x \quad \textrm{for} \,\, i \in 1, \dots, \kappa / k.
        \end{displaymath}

    \item S computes: \\
        \begin{displaymath}
            r_x^{i} = \mathsf{PRG}(F^{*i}(x)) \in \mathbb{F}_2^{l'} \quad \textrm{for} \,\, x \in F_{2^k} \setminus \{\Delta\},
        \end{displaymath}
        \begin{displaymath}
            w^i = \sum_{x \in F_{2^k} \setminus \{\Delta\}} r_x^{i} \cdot (\Delta^i - x) \quad \textrm{for} \,\, i \in 1, ..., \kappa / k.
        \end{displaymath}
      
    \item R inputs the choice bits $x_1, \dots, x_l \in \mathbb{F}_2$. Let $l' = l + s$, and assume that $s|l$. R picks random $x_{l+1}, \dots, x_{l+s} \in \mathbb{F}_2$ and sets $\mathbf{x} = (x_1, ..., x_{l'})$. \\
    
    R computes:
    \begin{displaymath}
        u^i = u^i + \mathbf{x} \quad \textrm{for} \,\, i \in 1, \dots, \kappa / k \,,
    \end{displaymath}
    \begin{displaymath}
        \chi_j = \mathsf{H}_1(j || u) \quad \textrm{for} \,\, j \in 1, \dots, m.
    \end{displaymath} 
    
    \emph{Consistency check:} Let $m = l/s$. We divide $l'$ OTs into $m+1$ blocks of $s$ bits,
        writing $\mathbf{x} = (\hat{x}_1, \dots, \hat{x}_{m+1}) \in \mathbb{F}_{2^s}^{m+1}$,
        and similarly
        $v^i = (\hat{v}^i_1, \dots, \hat{v}^i_{m+1}) \in \mathbb{F}_{2^s}^{m+1}$. Then R computes the following values over $F_{2^s}$: 
    \begin{displaymath}
        x = \sum_{j=1}^m \hat{x}_j \cdot \chi_j + \hat{x}_{m+1}, \quad 
        t^i = \sum_{j=1}^m \hat{v}^i_j \cdot \chi_j + \hat{v}^i_{m+1} \quad \textrm{for} \,\, i \in 1, \dots, \kappa / k
    \end{displaymath}        
    and sends $u^i$, $x$, $t^i$ to S.

    \item S computes: 
        \begin{displaymath}
            \mathbf{q}^i = \Delta^i \cdot u^i + w^i, \quad \textrm{for} \,\, i \in 1, \dots, \kappa / k
        \end{displaymath}
        \begin{displaymath}
            \mathbf{q}^i = (\hat{q}^i_1, ..., \hat{q}^i_{m+1}) \in \mathbb{F}_{2^s}^{m+1}
        \end{displaymath}
        \begin{displaymath}
            \chi_j = \mathsf{H}_1(j || u), \quad \textrm{for} \,\, j \in 1, \dots, m 
        \end{displaymath}
        \begin{displaymath}
            q^i = \sum_{j=1}^m \hat{q}^i_j \cdot \chi_j + \hat{q}^i_{m+1}, \quad \textrm{for} \,\, i \in 1, \dots, \kappa / k
        \end{displaymath}
        and checks that $q^i = t^i + \Delta^i \cdot x$, for all $i \in 1, \dots, \kappa / k$. If any check fails, output \bf{AbortAndBanParty}.
    
  \end{enumerate}


\paragraph{Transpose and randomize:}
    \begin{enumerate}
        \item Let $\mathbf{q}_j$ denote the $j$-th row of the $l' \times \kappa$ bit matrix $[\mathbf{q}^1| \dots |\mathbf{q}^{\kappa}]$ held by S, and similarly let $v_j$ be the $j$-th row of $[v^1| \dots |v^{\kappa}]$, held by R.

        \item R outputs
            \begin{displaymath}
                out_{x_j,j} = \mathsf{H}_2(j || v_j), \quad j \in [l].
            \end{displaymath}

        \item S outputs 
            \begin{displaymath}
                out_{0,j} = \mathsf{H}_2(j || \mathbf{q}_j) \quad \textrm{and} \quad out_{1,j} = \mathsf{H}_2(j || (\mathbf{q}_j + \Delta)), \quad j \in [l].
            \end{displaymath}
    \end{enumerate}

$\heartsuit$

\bibliographystyle{unsrt} 
\bibliography{mybib}

\end{document}
